close all
clear all
clc

%use matlab from R2020a version
%CHANGE THE MATRIX F AND THE DATA USED FOR TT
%1st type

%% CALDERSMITH
%% data

rho = 620; %density plywood
rhoA = 1.225; %density air
a = 0.425;
b = 0.299;
h = 0.003;
t = 0.0025;    %thickness hole 2nd type
N = 50;     %number of holes

R = [0.0045, 0.0075     %semi axis y and x ellipse  3-5 (9mm, 15mm)
     0.003, 0.009       %3-9 (6mm, 18mm)
     0.0045, 0.0135];   %3-9 (9mm, 27mm)
 
dim = size(R,1);

%% Calculations

volM = zeros(dim,1);
volDiff = zeros(dim,1);
massaDiff = zeros(dim,1);
massaM = zeros(dim,1);
massaTot = zeros(dim,1);
rhoh = zeros(dim,1);

volTot = a*b*h;                         %total volume of the plate
for k = 1:dim
    volM(k) = pi*R(k,1)*R(k,2)*t*N;     %total volume of the holes
    volDiff(k) = volTot - volM(k);      %volume only plywood
    massaDiff(k) = volDiff(k)*rho;      %mass only plywood
    massaM(k) = volM(k)*rhoA;           %mass only air
    massaTot(k) = massaDiff(k) + massaM(k);
    rhoh(k) = massaTot(k)/volTot;
end

%% natural freq of the tapa, from comsol eigenfreq
%    f02,    f20,     f11
F = [72.304, 106.15, 30.542        %normal tapa
     72.481, 106.14, 30.582;        %tapa 9mm-15mm HORIZONTAL
     72.396, 106.18, 30.563;        %tapa 6mm-18mm HORIZONTAL
     72.559, 106.24, 30.602];       %tapa 9mm-27mm HORIZONTAL 

% F = [72.304, 106.15, 30.542        %normal tapa
%      72.563, 106,    30.579;        %tapa 9mm-15mm VERTICAL
%      72.539, 105.96, 30.571;        %tapa 6mm-18mm VERTICAL
%      72.864, 105.75, 30.613];       %tapa 9mm-27mm VERTICAL
 
%% Caldersmith's formulae  (constants for elastic deformation)
Dh = zeros(3,dim);
Eh = zeros(2,dim);
Gh = zeros(1,dim);

%true values
El = 11140*10^6;
Er = 5880*10^6;
Glr = 910*10^6;

%values for the normal tapa
D = [0.08006, 0.08006, 0.274]'.*[a^4, b^4, a^2*b^2]'.*(F(1,:)'.^2)*rho./(h^2); 
E = [12*D(1,1); 12*D(2,1)];
G = 3*D(3,1);

%error calculation
El_err = abs((El - E(1,1)))/El*100;
Er_err = abs((Er - E(2,1)))/Er*100;
fprintf('Error bars: El = %.1f%%,  Er = %.1f%%\n', El_err, Er_err);
Glr_err = abs((Glr - G)/Glr)*100;
fprintf('Error bars: Glr = %.1f%%\n\n', Glr_err);

%values for the tapa with holes
for j = 1:dim
    Dh(:,j) = [0.08006, 0.08006, 0.274]'.*[a^4, b^4, a^2*b^2]'.*(F(j+1,:)'.^2)*rhoh(j)./(h^2); 
    Eh(1,j) = 12*Dh(1,j);
    Eh(2,j) = 12*Dh(2,j);
    Gh(1,j) = 3*Dh(3,j);
end


diff = zeros(3,1);
diffE = zeros(2,1);
index = [1,3,4];
for i = 1:dim
    fprintf('case %d: holes of %.2fmm-%.2fmm\n',i,2*R(i,1)*10^3,2*R(i,2)*10^3)
    fprintf('New density %d = %.1f\nDensity variation = %.1f%%\n',i, rhoh(i), (1- rhoh(i)/rho)*100);
    for m = 1:3
        diff(m,i) = (1- Dh(m,i)/D(m,1))*100;
        fprintf('D%d = %d, D%dh = %d\n',index(m),D(m,1),index(m),Dh(m,i))
        fprintf('Percentage variation D%d = %.1f%%\n',index(m),diff(m,i))
    end
    fprintf('E1 = %d, E1h = %d\nE2 = %d, E2h = %d\n',E(1,1),Eh(1,i),E(2,1),Eh(2,i))
    for n = 1:2
        diffE(n,i) = (1- Eh(n,i)/E(n,1))*100;
        fprintf('Percentage variation E%d = %.1f%%\n',n,diffE(n,i))
    end
    diffG = (1- Gh(1,i)/G)*100;
    
    fprintf('G = %d, Gh = %d\n',G,Gh(1,i))
    fprintf('Percentage variation G = %.1f%%\n\n',diffG)
    
end



%% TRACTION TEST
% tapa 9-15 mm HORIZONTAL
data11 = [10000	1.1140E10
11000	1.1140E10
12000	1.1140E10
13000	1.1140E10
14000	1.1140E10
15000	1.1140E10
16000	1.1140E10
17000	1.1140E10
18000	1.1140E10
19000	1.1140E10
20000	1.1140E10
21000	1.1140E10
22000	1.1140E10
23000	1.1140E10
24000	1.1140E10
25000	1.1140E10
26000	1.1140E10
27000	1.1140E10
28000	1.1140E10
29000	1.1140E10
30000	1.1140E10
31000	1.1140E10
32000	1.1140E10
33000	1.1140E10
34000	1.1140E10
35000	1.1140E10
36000	1.1140E10
37000	1.1140E10
38000	1.1140E10
39000	1.1140E10
40000	1.1140E10
41000	1.1140E10
42000	1.1140E10
43000	1.1140E10
44000	1.1140E10
45000	1.1140E10
46000	1.1140E10
47000	1.1140E10
48000	1.1140E10
49000	1.1140E10
50000	1.1140E10
51000	1.1140E10
52000	1.1140E10
53000	1.1140E10
54000	1.1140E10
55000	1.1140E10
56000	1.1140E10
57000	1.1140E10
58000	1.1140E10
59000	1.1140E10
60000	1.1140E10
61000	1.1140E10
62000	1.1140E10
63000	1.1140E10
64000	1.1140E10
65000	1.1140E10
66000	1.1140E10
67000	1.1140E10
68000	1.1140E10
69000	1.1140E10
70000	1.1140E10
71000	1.1140E10
72000	1.1140E10
73000	1.1140E10
74000	1.1140E10
75000	1.1140E10
76000	1.1140E10
77000	1.1140E10
78000	1.1140E10
79000	1.1140E10
80000	1.1140E10
81000	1.1140E10
82000	1.1140E10
83000	1.1140E10
84000	1.1140E10
85000	1.1140E10
86000	1.1140E10
87000	1.1140E10
88000	1.1140E10
89000	1.1140E10
90000	1.1140E10
91000	1.1140E10
92000	1.1140E10
93000	1.1140E10
94000	1.1140E10
95000	1.1140E10
96000	1.1140E10
97000	1.1140E10
98000	1.1140E10
99000	1.1140E10
1.0000E5	1.1140E10];

data12 = [10000	5.8799E9
11000	5.8799E9
12000	5.8799E9
13000	5.8799E9
14000	5.8799E9
15000	5.8799E9
16000	5.8799E9
17000	5.8799E9
18000	5.8799E9
19000	5.8799E9
20000	5.8799E9
21000	5.8799E9
22000	5.8799E9
23000	5.8799E9
24000	5.8799E9
25000	5.8799E9
26000	5.8799E9
27000	5.8799E9
28000	5.8799E9
29000	5.8799E9
30000	5.8799E9
31000	5.8799E9
32000	5.8799E9
33000	5.8799E9
34000	5.8799E9
35000	5.8799E9
36000	5.8799E9
37000	5.8799E9
38000	5.8799E9
39000	5.8799E9
40000	5.8799E9
41000	5.8799E9
42000	5.8799E9
43000	5.8799E9
44000	5.8799E9
45000	5.8799E9
46000	5.8799E9
47000	5.8799E9
48000	5.8799E9
49000	5.8799E9
50000	5.8799E9
51000	5.8799E9
52000	5.8799E9
53000	5.8799E9
54000	5.8799E9
55000	5.8799E9
56000	5.8799E9
57000	5.8799E9
58000	5.8799E9
59000	5.8799E9
60000	5.8799E9
61000	5.8799E9
62000	5.8799E9
63000	5.8799E9
64000	5.8799E9
65000	5.8799E9
66000	5.8799E9
67000	5.8799E9
68000	5.8799E9
69000	5.8799E9
70000	5.8799E9
71000	5.8799E9
72000	5.8799E9
73000	5.8799E9
74000	5.8799E9
75000	5.8799E9
76000	5.8799E9
77000	5.8799E9
78000	5.8799E9
79000	5.8799E9
80000	5.8799E9
81000	5.8799E9
82000	5.8799E9
83000	5.8799E9
84000	5.8799E9
85000	5.8799E9
86000	5.8799E9
87000	5.8799E9
88000	5.8799E9
89000	5.8799E9
90000	5.8799E9
91000	5.8799E9
92000	5.8799E9
93000	5.8799E9
94000	5.8799E9
95000	5.8799E9
96000	5.8799E9
97000	5.8799E9
98000	5.8799E9
99000	5.8799E9
1.0000E5	5.8799E9];
% %% tapa 6-18 HORIZONTAL
data21 = [10000	1.1140E10
11000	1.1140E10
12000	1.1140E10
13000	1.1140E10
14000	1.1140E10
15000	1.1140E10
16000	1.1140E10
17000	1.1140E10
18000	1.1140E10
19000	1.1140E10
20000	1.1140E10
21000	1.1140E10
22000	1.1140E10
23000	1.1140E10
24000	1.1140E10
25000	1.1140E10
26000	1.1140E10
27000	1.1140E10
28000	1.1140E10
29000	1.1140E10
30000	1.1140E10
31000	1.1140E10
32000	1.1140E10
33000	1.1140E10
34000	1.1140E10
35000	1.1140E10
36000	1.1140E10
37000	1.1140E10
38000	1.1140E10
39000	1.1140E10
40000	1.1140E10
41000	1.1140E10
42000	1.1140E10
43000	1.1140E10
44000	1.1140E10
45000	1.1140E10
46000	1.1140E10
47000	1.1140E10
48000	1.1140E10
49000	1.1140E10
50000	1.1140E10
51000	1.1140E10
52000	1.1140E10
53000	1.1140E10
54000	1.1140E10
55000	1.1140E10
56000	1.1140E10
57000	1.1140E10
58000	1.1140E10
59000	1.1140E10
60000	1.1140E10
61000	1.1140E10
62000	1.1140E10
63000	1.1140E10
64000	1.1140E10
65000	1.1140E10
66000	1.1140E10
67000	1.1140E10
68000	1.1140E10
69000	1.1140E10
70000	1.1140E10
71000	1.1140E10
72000	1.1140E10
73000	1.1140E10
74000	1.1140E10
75000	1.1140E10
76000	1.1140E10
77000	1.1140E10
78000	1.1140E10
79000	1.1140E10
80000	1.1140E10
81000	1.1140E10
82000	1.1140E10
83000	1.1140E10
84000	1.1140E10
85000	1.1140E10
86000	1.1140E10
87000	1.1140E10
88000	1.1140E10
89000	1.1140E10
90000	1.1140E10
91000	1.1140E10
92000	1.1140E10
93000	1.1140E10
94000	1.1140E10
95000	1.1140E10
96000	1.1140E10
97000	1.1140E10
98000	1.1140E10
99000	1.1140E10
1.0000E5	1.1140E10];

data22 = [10000	5.8799E9
11000	5.8799E9
12000	5.8799E9
13000	5.8799E9
14000	5.8799E9
15000	5.8799E9
16000	5.8799E9
17000	5.8799E9
18000	5.8799E9
19000	5.8799E9
20000	5.8799E9
21000	5.8799E9
22000	5.8799E9
23000	5.8799E9
24000	5.8799E9
25000	5.8799E9
26000	5.8799E9
27000	5.8799E9
28000	5.8799E9
29000	5.8799E9
30000	5.8799E9
31000	5.8799E9
32000	5.8799E9
33000	5.8799E9
34000	5.8799E9
35000	5.8799E9
36000	5.8799E9
37000	5.8799E9
38000	5.8799E9
39000	5.8799E9
40000	5.8799E9
41000	5.8799E9
42000	5.8799E9
43000	5.8799E9
44000	5.8799E9
45000	5.8799E9
46000	5.8799E9
47000	5.8799E9
48000	5.8799E9
49000	5.8799E9
50000	5.8799E9
51000	5.8799E9
52000	5.8799E9
53000	5.8799E9
54000	5.8799E9
55000	5.8799E9
56000	5.8799E9
57000	5.8799E9
58000	5.8799E9
59000	5.8799E9
60000	5.8799E9
61000	5.8799E9
62000	5.8799E9
63000	5.8799E9
64000	5.8799E9
65000	5.8799E9
66000	5.8799E9
67000	5.8799E9
68000	5.8799E9
69000	5.8799E9
70000	5.8799E9
71000	5.8799E9
72000	5.8799E9
73000	5.8799E9
74000	5.8799E9
75000	5.8799E9
76000	5.8799E9
77000	5.8799E9
78000	5.8799E9
79000	5.8799E9
80000	5.8799E9
81000	5.8799E9
82000	5.8799E9
83000	5.8799E9
84000	5.8799E9
85000	5.8799E9
86000	5.8799E9
87000	5.8799E9
88000	5.8799E9
89000	5.8799E9
90000	5.8799E9
91000	5.8799E9
92000	5.8799E9
93000	5.8799E9
94000	5.8799E9
95000	5.8799E9
96000	5.8799E9
97000	5.8799E9
98000	5.8799E9
99000	5.8799E9
1.0000E5	5.8799E9];

%tapa 9-27
data31 = [10000	1.1140E10
11000	1.1140E10
12000	1.1140E10
13000	1.1140E10
14000	1.1140E10
15000	1.1140E10
16000	1.1140E10
17000	1.1140E10
18000	1.1140E10
19000	1.1140E10
20000	1.1140E10
21000	1.1140E10
22000	1.1140E10
23000	1.1140E10
24000	1.1140E10
25000	1.1140E10
26000	1.1140E10
27000	1.1140E10
28000	1.1140E10
29000	1.1140E10
30000	1.1140E10
31000	1.1140E10
32000	1.1140E10
33000	1.1140E10
34000	1.1140E10
35000	1.1140E10
36000	1.1140E10
37000	1.1140E10
38000	1.1140E10
39000	1.1140E10
40000	1.1140E10
41000	1.1140E10
42000	1.1140E10
43000	1.1140E10
44000	1.1140E10
45000	1.1140E10
46000	1.1140E10
47000	1.1140E10
48000	1.1140E10
49000	1.1140E10
50000	1.1140E10
51000	1.1140E10
52000	1.1140E10
53000	1.1140E10
54000	1.1140E10
55000	1.1140E10
56000	1.1140E10
57000	1.1140E10
58000	1.1140E10
59000	1.1140E10
60000	1.1140E10
61000	1.1140E10
62000	1.1140E10
63000	1.1140E10
64000	1.1140E10
65000	1.1140E10
66000	1.1140E10
67000	1.1140E10
68000	1.1140E10
69000	1.1140E10
70000	1.1140E10
71000	1.1140E10
72000	1.1140E10
73000	1.1140E10
74000	1.1140E10
75000	1.1140E10
76000	1.1140E10
77000	1.1140E10
78000	1.1140E10
79000	1.1140E10
80000	1.1140E10
81000	1.1140E10
82000	1.1140E10
83000	1.1140E10
84000	1.1140E10
85000	1.1140E10
86000	1.1140E10
87000	1.1140E10
88000	1.1140E10
89000	1.1140E10
90000	1.1140E10
91000	1.1140E10
92000	1.1140E10
93000	1.1140E10
94000	1.1140E10
95000	1.1140E10
96000	1.1140E10
97000	1.1140E10
98000	1.1140E10
99000	1.1140E10
1.0000E5	1.1140E10];

data32 = [10000	5.8798E9
11000	5.8798E9
12000	5.8798E9
13000	5.8798E9
14000	5.8798E9
15000	5.8798E9
16000	5.8798E9
17000	5.8798E9
18000	5.8798E9
19000	5.8798E9
20000	5.8798E9
21000	5.8798E9
22000	5.8798E9
23000	5.8798E9
24000	5.8798E9
25000	5.8798E9
26000	5.8798E9
27000	5.8798E9
28000	5.8798E9
29000	5.8798E9
30000	5.8798E9
31000	5.8798E9
32000	5.8798E9
33000	5.8798E9
34000	5.8798E9
35000	5.8798E9
36000	5.8798E9
37000	5.8798E9
38000	5.8798E9
39000	5.8798E9
40000	5.8798E9
41000	5.8798E9
42000	5.8798E9
43000	5.8798E9
44000	5.8798E9
45000	5.8798E9
46000	5.8798E9
47000	5.8798E9
48000	5.8798E9
49000	5.8798E9
50000	5.8798E9
51000	5.8798E9
52000	5.8798E9
53000	5.8798E9
54000	5.8798E9
55000	5.8798E9
56000	5.8798E9
57000	5.8798E9
58000	5.8798E9
59000	5.8798E9
60000	5.8798E9
61000	5.8798E9
62000	5.8798E9
63000	5.8798E9
64000	5.8798E9
65000	5.8798E9
66000	5.8798E9
67000	5.8798E9
68000	5.8798E9
69000	5.8798E9
70000	5.8798E9
71000	5.8798E9
72000	5.8798E9
73000	5.8798E9
74000	5.8798E9
75000	5.8798E9
76000	5.8798E9
77000	5.8798E9
78000	5.8798E9
79000	5.8798E9
80000	5.8798E9
81000	5.8798E9
82000	5.8798E9
83000	5.8798E9
84000	5.8798E9
85000	5.8798E9
86000	5.8798E9
87000	5.8798E9
88000	5.8798E9
89000	5.8798E9
90000	5.8798E9
91000	5.8798E9
92000	5.8798E9
93000	5.8798E9
94000	5.8798E9
95000	5.8798E9
96000	5.8798E9
97000	5.8798E9
98000	5.8798E9
99000	5.8798E9
1.0000E5	5.8798E9];

%% tapa 9-15 E1 e E2 VERTICAL 1st TYPE
% data11 = [10000	1.1140E10
% 11000	1.1140E10
% 12000	1.1140E10
% 13000	1.1140E10
% 14000	1.1140E10
% 15000	1.1140E10
% 16000	1.1140E10
% 17000	1.1140E10
% 18000	1.1140E10
% 19000	1.1140E10
% 20000	1.1140E10
% 21000	1.1140E10
% 22000	1.1140E10
% 23000	1.1140E10
% 24000	1.1140E10
% 25000	1.1140E10
% 26000	1.1140E10
% 27000	1.1140E10
% 28000	1.1140E10
% 29000	1.1140E10
% 30000	1.1140E10
% 31000	1.1140E10
% 32000	1.1140E10
% 33000	1.1140E10
% 34000	1.1140E10
% 35000	1.1140E10
% 36000	1.1140E10
% 37000	1.1140E10
% 38000	1.1140E10
% 39000	1.1140E10
% 40000	1.1140E10
% 41000	1.1140E10
% 42000	1.1140E10
% 43000	1.1140E10
% 44000	1.1140E10
% 45000	1.1140E10
% 46000	1.1140E10
% 47000	1.1140E10
% 48000	1.1140E10
% 49000	1.1140E10
% 50000	1.1140E10
% 51000	1.1140E10
% 52000	1.1140E10
% 53000	1.1140E10
% 54000	1.1140E10
% 55000	1.1140E10
% 56000	1.1140E10
% 57000	1.1140E10
% 58000	1.1140E10
% 59000	1.1140E10
% 60000	1.1140E10
% 61000	1.1140E10
% 62000	1.1140E10
% 63000	1.1140E10
% 64000	1.1140E10
% 65000	1.1140E10
% 66000	1.1140E10
% 67000	1.1140E10
% 68000	1.1140E10
% 69000	1.1140E10
% 70000	1.1140E10
% 71000	1.1140E10
% 72000	1.1140E10
% 73000	1.1140E10
% 74000	1.1140E10
% 75000	1.1140E10
% 76000	1.1140E10
% 77000	1.1140E10
% 78000	1.1140E10
% 79000	1.1140E10
% 80000	1.1140E10
% 81000	1.1140E10
% 82000	1.1140E10
% 83000	1.1140E10
% 84000	1.1140E10
% 85000	1.1140E10
% 86000	1.1140E10
% 87000	1.1140E10
% 88000	1.1140E10
% 89000	1.1140E10
% 90000	1.1140E10
% 91000	1.1140E10
% 92000	1.1140E10
% 93000	1.1140E10
% 94000	1.1140E10
% 95000	1.1140E10
% 96000	1.1140E10
% 97000	1.1140E10
% 98000	1.1140E10
% 99000	1.1140E10
% 1.0000E5	1.1140E10];
% 
% data12 = [10000	5.8798E9
% 11000	5.8798E9
% 12000	5.8798E9
% 13000	5.8798E9
% 14000	5.8798E9
% 15000	5.8798E9
% 16000	5.8798E9
% 17000	5.8798E9
% 18000	5.8798E9
% 19000	5.8798E9
% 20000	5.8798E9
% 21000	5.8798E9
% 22000	5.8798E9
% 23000	5.8798E9
% 24000	5.8798E9
% 25000	5.8798E9
% 26000	5.8798E9
% 27000	5.8798E9
% 28000	5.8798E9
% 29000	5.8798E9
% 30000	5.8798E9
% 31000	5.8798E9
% 32000	5.8798E9
% 33000	5.8798E9
% 34000	5.8798E9
% 35000	5.8798E9
% 36000	5.8798E9
% 37000	5.8798E9
% 38000	5.8798E9
% 39000	5.8798E9
% 40000	5.8798E9
% 41000	5.8798E9
% 42000	5.8798E9
% 43000	5.8798E9
% 44000	5.8798E9
% 45000	5.8798E9
% 46000	5.8798E9
% 47000	5.8798E9
% 48000	5.8798E9
% 49000	5.8798E9
% 50000	5.8798E9
% 51000	5.8798E9
% 52000	5.8798E9
% 53000	5.8798E9
% 54000	5.8798E9
% 55000	5.8798E9
% 56000	5.8798E9
% 57000	5.8798E9
% 58000	5.8798E9
% 59000	5.8798E9
% 60000	5.8798E9
% 61000	5.8798E9
% 62000	5.8798E9
% 63000	5.8798E9
% 64000	5.8798E9
% 65000	5.8798E9
% 66000	5.8798E9
% 67000	5.8798E9
% 68000	5.8798E9
% 69000	5.8798E9
% 70000	5.8798E9
% 71000	5.8798E9
% 72000	5.8798E9
% 73000	5.8798E9
% 74000	5.8798E9
% 75000	5.8798E9
% 76000	5.8798E9
% 77000	5.8798E9
% 78000	5.8798E9
% 79000	5.8798E9
% 80000	5.8798E9
% 81000	5.8798E9
% 82000	5.8798E9
% 83000	5.8798E9
% 84000	5.8798E9
% 85000	5.8798E9
% 86000	5.8798E9
% 87000	5.8798E9
% 88000	5.8798E9
% 89000	5.8798E9
% 90000	5.8798E9
% 91000	5.8798E9
% 92000	5.8798E9
% 93000	5.8798E9
% 94000	5.8798E9
% 95000	5.8798E9
% 96000	5.8798E9
% 97000	5.8798E9
% 98000	5.8798E9
% 99000	5.8798E9
% 1.0000E5	5.8798E9];
% 
% % tapa 6-18 VERTICAL
% data21 = [10000	1.1140E10
% 11000	1.1140E10
% 12000	1.1140E10
% 13000	1.1140E10
% 14000	1.1140E10
% 15000	1.1140E10
% 16000	1.1140E10
% 17000	1.1140E10
% 18000	1.1140E10
% 19000	1.1140E10
% 20000	1.1140E10
% 21000	1.1140E10
% 22000	1.1140E10
% 23000	1.1140E10
% 24000	1.1140E10
% 25000	1.1140E10
% 26000	1.1140E10
% 27000	1.1140E10
% 28000	1.1140E10
% 29000	1.1140E10
% 30000	1.1140E10
% 31000	1.1140E10
% 32000	1.1140E10
% 33000	1.1140E10
% 34000	1.1140E10
% 35000	1.1140E10
% 36000	1.1140E10
% 37000	1.1140E10
% 38000	1.1140E10
% 39000	1.1140E10
% 40000	1.1140E10
% 41000	1.1140E10
% 42000	1.1140E10
% 43000	1.1140E10
% 44000	1.1140E10
% 45000	1.1140E10
% 46000	1.1140E10
% 47000	1.1140E10
% 48000	1.1140E10
% 49000	1.1140E10
% 50000	1.1140E10
% 51000	1.1140E10
% 52000	1.1140E10
% 53000	1.1140E10
% 54000	1.1140E10
% 55000	1.1140E10
% 56000	1.1140E10
% 57000	1.1140E10
% 58000	1.1140E10
% 59000	1.1140E10
% 60000	1.1140E10
% 61000	1.1140E10
% 62000	1.1140E10
% 63000	1.1140E10
% 64000	1.1140E10
% 65000	1.1140E10
% 66000	1.1140E10
% 67000	1.1140E10
% 68000	1.1140E10
% 69000	1.1140E10
% 70000	1.1140E10
% 71000	1.1140E10
% 72000	1.1140E10
% 73000	1.1140E10
% 74000	1.1140E10
% 75000	1.1140E10
% 76000	1.1140E10
% 77000	1.1140E10
% 78000	1.1140E10
% 79000	1.1140E10
% 80000	1.1140E10
% 81000	1.1140E10
% 82000	1.1140E10
% 83000	1.1140E10
% 84000	1.1140E10
% 85000	1.1140E10
% 86000	1.1140E10
% 87000	1.1140E10
% 88000	1.1140E10
% 89000	1.1140E10
% 90000	1.1140E10
% 91000	1.1140E10
% 92000	1.1140E10
% 93000	1.1140E10
% 94000	1.1140E10
% 95000	1.1140E10
% 96000	1.1140E10
% 97000	1.1140E10
% 98000	1.1140E10
% 99000	1.1140E10
% 1.0000E5	1.1140E10];
% 
% data22 = [10000	5.8798E9
% 11000	5.8798E9
% 12000	5.8798E9
% 13000	5.8798E9
% 14000	5.8798E9
% 15000	5.8798E9
% 16000	5.8798E9
% 17000	5.8798E9
% 18000	5.8798E9
% 19000	5.8798E9
% 20000	5.8798E9
% 21000	5.8798E9
% 22000	5.8798E9
% 23000	5.8798E9
% 24000	5.8798E9
% 25000	5.8798E9
% 26000	5.8798E9
% 27000	5.8798E9
% 28000	5.8798E9
% 29000	5.8798E9
% 30000	5.8798E9
% 31000	5.8798E9
% 32000	5.8798E9
% 33000	5.8798E9
% 34000	5.8798E9
% 35000	5.8798E9
% 36000	5.8798E9
% 37000	5.8798E9
% 38000	5.8798E9
% 39000	5.8798E9
% 40000	5.8798E9
% 41000	5.8798E9
% 42000	5.8798E9
% 43000	5.8798E9
% 44000	5.8798E9
% 45000	5.8798E9
% 46000	5.8798E9
% 47000	5.8798E9
% 48000	5.8798E9
% 49000	5.8798E9
% 50000	5.8798E9
% 51000	5.8798E9
% 52000	5.8798E9
% 53000	5.8798E9
% 54000	5.8798E9
% 55000	5.8798E9
% 56000	5.8798E9
% 57000	5.8798E9
% 58000	5.8798E9
% 59000	5.8798E9
% 60000	5.8798E9
% 61000	5.8798E9
% 62000	5.8798E9
% 63000	5.8798E9
% 64000	5.8798E9
% 65000	5.8798E9
% 66000	5.8798E9
% 67000	5.8798E9
% 68000	5.8798E9
% 69000	5.8798E9
% 70000	5.8798E9
% 71000	5.8798E9
% 72000	5.8798E9
% 73000	5.8798E9
% 74000	5.8798E9
% 75000	5.8798E9
% 76000	5.8798E9
% 77000	5.8798E9
% 78000	5.8798E9
% 79000	5.8798E9
% 80000	5.8798E9
% 81000	5.8798E9
% 82000	5.8798E9
% 83000	5.8798E9
% 84000	5.8798E9
% 85000	5.8798E9
% 86000	5.8798E9
% 87000	5.8798E9
% 88000	5.8798E9
% 89000	5.8798E9
% 90000	5.8798E9
% 91000	5.8798E9
% 92000	5.8798E9
% 93000	5.8798E9
% 94000	5.8798E9
% 95000	5.8798E9
% 96000	5.8798E9
% 97000	5.8798E9
% 98000	5.8798E9
% 99000	5.8798E9
% 1.0000E5	5.8798E9];
% 
% % tapa 9-27 VERTICAL
% data31 = [10000	1.1140E10
% 11000	1.1140E10
% 12000	1.1140E10
% 13000	1.1140E10
% 14000	1.1140E10
% 15000	1.1140E10
% 16000	1.1140E10
% 17000	1.1140E10
% 18000	1.1140E10
% 19000	1.1140E10
% 20000	1.1140E10
% 21000	1.1140E10
% 22000	1.1140E10
% 23000	1.1140E10
% 24000	1.1140E10
% 25000	1.1140E10
% 26000	1.1140E10
% 27000	1.1140E10
% 28000	1.1140E10
% 29000	1.1140E10
% 30000	1.1140E10
% 31000	1.1140E10
% 32000	1.1140E10
% 33000	1.1140E10
% 34000	1.1140E10
% 35000	1.1140E10
% 36000	1.1140E10
% 37000	1.1140E10
% 38000	1.1140E10
% 39000	1.1140E10
% 40000	1.1140E10
% 41000	1.1140E10
% 42000	1.1140E10
% 43000	1.1140E10
% 44000	1.1140E10
% 45000	1.1140E10
% 46000	1.1140E10
% 47000	1.1140E10
% 48000	1.1140E10
% 49000	1.1140E10
% 50000	1.1140E10
% 51000	1.1140E10
% 52000	1.1140E10
% 53000	1.1140E10
% 54000	1.1140E10
% 55000	1.1140E10
% 56000	1.1140E10
% 57000	1.1140E10
% 58000	1.1140E10
% 59000	1.1140E10
% 60000	1.1140E10
% 61000	1.1140E10
% 62000	1.1140E10
% 63000	1.1140E10
% 64000	1.1140E10
% 65000	1.1140E10
% 66000	1.1140E10
% 67000	1.1140E10
% 68000	1.1140E10
% 69000	1.1140E10
% 70000	1.1140E10
% 71000	1.1140E10
% 72000	1.1140E10
% 73000	1.1140E10
% 74000	1.1140E10
% 75000	1.1140E10
% 76000	1.1140E10
% 77000	1.1140E10
% 78000	1.1140E10
% 79000	1.1140E10
% 80000	1.1140E10
% 81000	1.1140E10
% 82000	1.1140E10
% 83000	1.1140E10
% 84000	1.1140E10
% 85000	1.1140E10
% 86000	1.1140E10
% 87000	1.1140E10
% 88000	1.1140E10
% 89000	1.1140E10
% 90000	1.1140E10
% 91000	1.1140E10
% 92000	1.1140E10
% 93000	1.1140E10
% 94000	1.1140E10
% 95000	1.1140E10
% 96000	1.1140E10
% 97000	1.1140E10
% 98000	1.1140E10
% 99000	1.1140E10
% 1.0000E5	1.1140E10];
% 
% data32 = [10000	5.8795E9
% 11000	5.8795E9
% 12000	5.8795E9
% 13000	5.8795E9
% 14000	5.8795E9
% 15000	5.8795E9
% 16000	5.8795E9
% 17000	5.8795E9
% 18000	5.8795E9
% 19000	5.8795E9
% 20000	5.8795E9
% 21000	5.8795E9
% 22000	5.8795E9
% 23000	5.8795E9
% 24000	5.8795E9
% 25000	5.8795E9
% 26000	5.8795E9
% 27000	5.8795E9
% 28000	5.8795E9
% 29000	5.8795E9
% 30000	5.8795E9
% 31000	5.8795E9
% 32000	5.8795E9
% 33000	5.8795E9
% 34000	5.8795E9
% 35000	5.8795E9
% 36000	5.8795E9
% 37000	5.8795E9
% 38000	5.8795E9
% 39000	5.8795E9
% 40000	5.8795E9
% 41000	5.8795E9
% 42000	5.8795E9
% 43000	5.8795E9
% 44000	5.8795E9
% 45000	5.8795E9
% 46000	5.8795E9
% 47000	5.8795E9
% 48000	5.8795E9
% 49000	5.8795E9
% 50000	5.8795E9
% 51000	5.8795E9
% 52000	5.8795E9
% 53000	5.8795E9
% 54000	5.8795E9
% 55000	5.8795E9
% 56000	5.8795E9
% 57000	5.8795E9
% 58000	5.8795E9
% 59000	5.8795E9
% 60000	5.8795E9
% 61000	5.8795E9
% 62000	5.8795E9
% 63000	5.8795E9
% 64000	5.8795E9
% 65000	5.8795E9
% 66000	5.8795E9
% 67000	5.8795E9
% 68000	5.8795E9
% 69000	5.8795E9
% 70000	5.8795E9
% 71000	5.8795E9
% 72000	5.8795E9
% 73000	5.8795E9
% 74000	5.8795E9
% 75000	5.8795E9
% 76000	5.8795E9
% 77000	5.8795E9
% 78000	5.8795E9
% 79000	5.8795E9
% 80000	5.8795E9
% 81000	5.8795E9
% 82000	5.8795E9
% 83000	5.8795E9
% 84000	5.8795E9
% 85000	5.8795E9
% 86000	5.8795E9
% 87000	5.8795E9
% 88000	5.8795E9
% 89000	5.8795E9
% 90000	5.8795E9
% 91000	5.8795E9
% 92000	5.8795E9
% 93000	5.8795E9
% 94000	5.8795E9
% 95000	5.8795E9
% 96000	5.8795E9
% 97000	5.8795E9
% 98000	5.8795E9
% 99000	5.8795E9
% 1.0000E5	5.8795E9];

%% avg
E1 = [mean(data11(:,2),1), mean(data21(:,2),1), mean(data31(:,2),1)];
E2 = [mean(data12(:,2),1), mean(data22(:,2),1), mean(data32(:,2),1)];


%% Plot
figure(1)
scatter(rhoh(:,1), E1(1,:),'DisplayName', 'E1 TRACTION TEST 1st type holes')
hold on 
% scatter(rhoh(:,1), Eh(1,:),'DisplayName', 'E1 CALDERSMITH 1st type holes');
errorbar(rhoh(:,1), Eh(1,:),El_err*ones(size(rhoh))*El/100,'o','DisplayName', 'E1 CALDERSMITH 1st type holes');
yline(El, 'b--', 'LineWidth', 0.5,'DisplayName', 'True E1');
legend
xlabel('density [kg/m^3]')
ylabel('E [Pa]')
hold off


figure(2)
scatter(rhoh(:,1), E2(1,:),'DisplayName', 'E2 TRACTION TEST 1st type holes')
hold on
% scatter(rhoh(:,1), Eh(2,:),'DisplayName', 'E2 CALDERSMITH 1st type holes');
errorbar(rhoh(:,1), Eh(2,:),Er_err*ones(size(rhoh))*Er/100,'o','DisplayName', 'E2 CALDERSMITH 1st type holes');
yline(Er, 'b--', 'LineWidth', 0.5,'DisplayName', 'True E2');
legend
xlabel('density [kg/m^3]')
ylabel('E [Pa]')
hold off

